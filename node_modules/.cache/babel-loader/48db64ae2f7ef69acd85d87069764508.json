{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _Number$isInteger from \"@babel/runtime-corejs2/core-js/number/is-integer\";\nimport _parseInt from \"@babel/runtime-corejs2/core-js/parse-int\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport React from 'react';\nimport DashBoardLayOut from '../../layouts/DashboardLayOut';\nimport httpHelper from '../../helpers/httpHelper';\nimport SingleFarm from '../../components/singleFarm';\nimport { useRouter } from 'next/router';\nimport $ from 'jquery';\nimport Router from \"next/router\";\n\nvar allFarms =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(allFarms, _React$Component);\n\n  function allFarms(props) {\n    var _this;\n\n    _classCallCheck(this, allFarms);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(allFarms).call(this, props));\n    _this.state = {\n      farmDetails: ''\n    };\n    _this.handleChange = _this.handleChange.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(allFarms, [{\n    key: \"handleChange\",\n    value: function handleChange(e) {\n      var unitsToBuy = _parseInt(e.target.value);\n\n      if (!_Number$isInteger(unitsToBuy)) {\n        unitsToBuy = 0;\n      }\n\n      if (unitsToBuy > this.state.farmDetails.total_units - this.state.farmDetails.sold_out) {\n        unitsToBuy = this.state.farmDetails.total_units - this.state.farmDetails.sold_out;\n      }\n\n      this.calculateInvestment(unitsToBuy);\n      this.setState({\n        totalUnitsInput: unitsToBuy.toString(10).replace(/^0(?=[0-9]+)/, \"\")\n      });\n    }\n  }, {\n    key: \"calculateInvestment\",\n    value: function calculateInvestment(unitsToBuy) {\n      var totalPrice = this.state.farmDetails.price_per_unit * unitsToBuy;\n      var totalReturns = unitsToBuy * (this.state.farmDetails.roi * this.state.farmDetails.price_per_unit / 100);\n      var totalPayOut = totalPrice + totalReturns;\n      this.setState({\n        calcTotalPrice: totalPrice,\n        calcTotalReturns: totalReturns,\n        calcTotalPayOut: totalPayOut\n      });\n    }\n  }, {\n    key: \"calculateMonth\",\n    value: function calculateMonth(d1, d2) {\n      var months;\n      months = (d2.getFullYear() - d1.getFullYear()) * 12;\n      months -= d1.getMonth();\n      months += d2.getMonth();\n      return months <= 0 ? 0 : months;\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      httpHelper.serverReq(\"http://localhost:3009/api/v1/farms/\" + this.props.farmId).then(function (data) {\n        if (data.success && data.success.data) {\n          _this2.setState({\n            farmDetails: data.success.data,\n            totalUnitsInput: 1\n          });\n\n          _this2.calculateInvestment(_this2.state.totalUnitsInput);\n        } else {\n          return Router.push('/404');\n        }\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(DashBoardLayOut, null, React.createElement(\"section\", {\n        className: \"tabs\",\n        id: \"tabs\"\n      }, React.createElement(\"div\", {\n        className: \"col-sm-12\"\n      }, React.createElement(\"div\", {\n        className: \"panel panel-primary\",\n        \"data-collapsed\": \"0\"\n      }, React.createElement(\"div\", {\n        className: \"panel-body\"\n      }, React.createElement(\"div\", {\n        className: \"row\"\n      }, React.createElement(\"h2\", {\n        className: \"alert\"\n      }, \"You are about to fund this farm !\"), React.createElement(\"p\", {\n        className: \"p-alert\"\n      }, \" You can fund this farm by increasing or reducing the number of units to suit what you\\u2019d love to fund. As your number of farms changes, The Total Price, Total Returns and Total Payout are automatically calculated for you to see. Satisfied? Click on Pay Now.\"))))), React.createElement(\"div\", {\n        className: \"col-sm-12\"\n      }, React.createElement(\"div\", {\n        className: \"panel panel-primary\",\n        \"data-collapsed\": \"0\"\n      }, React.createElement(\"div\", {\n        className: \"panel-body\"\n      }, React.createElement(\"div\", {\n        className: \"col-md-6\"\n      }, React.createElement(\"div\", {\n        className: \"row\"\n      }, React.createElement(\"div\", {\n        className: \"col-md-8 fundh2 text-center\"\n      }, React.createElement(\"p\", null, \"Selected Farm\"), React.createElement(\"strong\", null, this.state.farmDetails.title))), React.createElement(\"div\", {\n        className: \"row\"\n      }, React.createElement(\"div\", {\n        className: \"col-md-6\"\n      }, React.createElement(\"p\", null, \"Price Per Unit\"), React.createElement(\"p\", {\n        className: \"ptag\"\n      }, \"\\u20A6\", this.state.farmDetails.price_per_unit)), React.createElement(\"div\", {\n        className: \"col-md-6\"\n      }, React.createElement(\"p\", {\n        className: \"\"\n      }, \"Returns\"), React.createElement(\"p\", {\n        className: \"ptag\"\n      }, this.state.farmDetails.roi, \"%\"))), React.createElement(\"div\", {\n        className: \"row\",\n        id: \"row2\"\n      }, React.createElement(\"div\", {\n        className: \"col-md-\"\n      }, React.createElement(\"div\", {\n        className: \"col-md-6\"\n      }, React.createElement(\"p\", null, \"Total units\"), React.createElement(\"p\", {\n        className: \"ptag\"\n      }, this.state.farmDetails.total_units)), React.createElement(\"div\", {\n        className: \"col-md-6\"\n      }, React.createElement(\"p\", {\n        className: \"\"\n      }, \"Available\"), React.createElement(\"p\", {\n        className: \"ptag\"\n      }, this.state.farmDetails.total_units - this.state.farmDetails.sold_out)))), React.createElement(\"div\", {\n        className: \"row\"\n      }, React.createElement(\"div\", {\n        className: \"col-md-\"\n      }, React.createElement(\"div\", {\n        className: \"col-md-6\"\n      }, React.createElement(\"p\", null, \"Duration\"), React.createElement(\"p\", {\n        className: \"ptag\"\n      }, this.calculateMonth(new Date(this.state.farmDetails.funding_starts), new Date(this.state.farmDetails.funding_ends)), \" month(s)\"))))), React.createElement(\"div\", {\n        className: \"col-md-6\"\n      }, React.createElement(\"div\", {\n        className: \"row\"\n      }, React.createElement(\"div\", {\n        className: \"col-md-12\"\n      }, React.createElement(\"h2\", {\n        className: \"fundh21 text-center\"\n      }, React.createElement(\"strong\", null, \"Confirmation\"))), React.createElement(\"br\", null), React.createElement(\"div\", {\n        className: \"row text-center\"\n      }, React.createElement(\"div\", {\n        className: \"col-md-4\"\n      }, React.createElement(\"p\", {\n        className: \"\"\n      }, \"No of units\"), React.createElement(\"input\", {\n        name: \"units\",\n        type: \"number\",\n        className: \"col-sm-2 form-control input-unit\",\n        placeholder: '1 to ' + (this.state.farmDetails.total_units - this.state.farmDetails.sold_out),\n        value: this.state.totalUnitsInput,\n        min: \"1\",\n        max: this.state.farmDetails.total_units - this.state.farmDetails.sold_out,\n        onChange: this.handleChange\n      })), React.createElement(\"div\", {\n        className: \"col-md-4\"\n      }, React.createElement(\"p\", {\n        className: \"\"\n      }, \"Unit Price\"), React.createElement(\"p\", {\n        className: \"ptag\"\n      }, \" \\u20A6\", this.state.farmDetails.price_per_unit)), React.createElement(\"div\", {\n        className: \"col-md-4\"\n      }, React.createElement(\"p\", {\n        className: \"\"\n      }, \"Return & duration\"), React.createElement(\"p\", {\n        className: \"ptag\"\n      }, this.state.farmDetails.roi, \"% in \", this.calculateMonth(new Date(this.state.farmDetails.funding_starts), new Date(this.state.farmDetails.funding_ends)), \" month(s)\"))), React.createElement(\"div\", {\n        className: \"row text-center\",\n        id: \"row2\"\n      }, React.createElement(\"div\", {\n        className: \"col-md-4\"\n      }, React.createElement(\"p\", {\n        className: \"\"\n      }, \"Total Price\"), React.createElement(\"p\", {\n        className: \"ptag\"\n      }, \" \\u20A6\", this.state.calcTotalPrice)), React.createElement(\"div\", {\n        className: \"col-md-4\"\n      }, React.createElement(\"p\", {\n        className: \"\"\n      }, \"Total Returns\"), React.createElement(\"p\", {\n        className: \"ptag\"\n      }, \" \\u20A6\", this.state.calcTotalReturns)), React.createElement(\"div\", {\n        className: \"col-md-4\"\n      }, React.createElement(\"p\", {\n        className: \"\"\n      }, \"Total Payout\"), React.createElement(\"p\", {\n        className: \"ptag\"\n      }, \" \\u20A6\", this.state.calcTotalPayOut)))), React.createElement(\"div\", {\n        className: \"row\"\n      }, React.createElement(\"div\", {\n        className: \"col-sm-2\"\n      }, React.createElement(\"a\", {\n        href: \"#\"\n      }, React.createElement(\"button\", {\n        type: \"button\",\n        disabled: this.state.isEnabled ? \"\" : \"disabled\",\n        className: \"btn btn-success\"\n      }, \"Fund Now\"))))))))));\n    }\n  }], [{\n    key: \"getInitialProps\",\n    value: function () {\n      var _getInitialProps = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(_ref) {\n        var req;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                req = _ref.req;\n                return _context.abrupt(\"return\", {\n                  farmId: req.params.farmId\n                });\n\n              case 2:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      function getInitialProps(_x) {\n        return _getInitialProps.apply(this, arguments);\n      }\n\n      return getInitialProps;\n    }()\n  }]);\n\n  return allFarms;\n}(React.Component);\n\nexport default allFarms;","map":{"version":3,"sources":["C:\\xampp\\htdocs\\easycow\\pages\\user\\fundFarm.js"],"names":["React","DashBoardLayOut","httpHelper","SingleFarm","useRouter","$","Router","allFarms","props","state","farmDetails","handleChange","bind","e","unitsToBuy","target","value","total_units","sold_out","calculateInvestment","setState","totalUnitsInput","toString","replace","totalPrice","price_per_unit","totalReturns","roi","totalPayOut","calcTotalPrice","calcTotalReturns","calcTotalPayOut","d1","d2","months","getFullYear","getMonth","serverReq","farmId","then","data","success","push","title","calculateMonth","Date","funding_starts","funding_ends","isEnabled","req","params","Component"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport DashBoardLayOut from '../../layouts/DashboardLayOut';\r\nimport httpHelper from '../../helpers/httpHelper';\r\nimport SingleFarm from '../../components/singleFarm';\r\nimport { useRouter } from 'next/router';\r\nimport $ from 'jquery';\r\nimport Router from \"next/router\";\r\n\r\nclass allFarms extends React.Component{\r\n\r\n  constructor(props){\r\n    super(props);\r\n    this.state = {farmDetails:''};\r\n    this.handleChange = this.handleChange.bind(this);\r\n  }\r\n\r\n  static async getInitialProps({ req }) {\r\n    return {farmId:req.params.farmId};\r\n  }\r\n\r\n  handleChange(e){\r\n    let unitsToBuy = parseInt(e.target.value);\r\n    if (!Number.isInteger(unitsToBuy)){\r\n     unitsToBuy = 0;\r\n    }\r\n\r\n    if (unitsToBuy > (this.state.farmDetails.total_units - this.state.farmDetails.sold_out)){\r\n      unitsToBuy = this.state.farmDetails.total_units - this.state.farmDetails.sold_out;\r\n    }\r\n    this.calculateInvestment(unitsToBuy);\r\n    this.setState({totalUnitsInput:unitsToBuy.toString(10).replace(/^0(?=[0-9]+)/,\"\")});\r\n  }\r\n\r\n  calculateInvestment(unitsToBuy){\r\n    let totalPrice = this.state.farmDetails.price_per_unit * unitsToBuy;\r\n    let totalReturns = unitsToBuy * ((this.state.farmDetails.roi * this.state.farmDetails.price_per_unit)/100);\r\n    let totalPayOut   = totalPrice + totalReturns;\r\n    this.setState({calcTotalPrice:totalPrice,calcTotalReturns:totalReturns,calcTotalPayOut:totalPayOut})\r\n  }\r\n\r\n  calculateMonth(d1,d2){\r\n    var months;\r\n    months = (d2.getFullYear() - d1.getFullYear()) * 12;\r\n    months -= d1.getMonth();\r\n    months += d2.getMonth();\r\n    return months <= 0 ? 0 : months;\r\n  }\r\n\r\n  componentDidMount() {\r\n    httpHelper.serverReq(\"http://localhost:3009/api/v1/farms/\"+this.props.farmId).then( (data)=> {\r\n      if (data.success && data.success.data){\r\n\r\n        this.setState({farmDetails:data.success.data,totalUnitsInput:1});\r\n        this.calculateInvestment(this.state.totalUnitsInput);\r\n\r\n      }else{\r\n        return   Router.push('/404')\r\n\r\n      }\r\n    })\r\n  }\r\n\r\n\r\n  render() {\r\n    return(\r\n      <DashBoardLayOut>\r\n\r\n        <section className=\"tabs\" id=\"tabs\">\r\n          <div className=\"col-sm-12\">\r\n            <div className=\"panel panel-primary\" data-collapsed=\"0\">\r\n              <div className=\"panel-body\">\r\n                <div className=\"row\">\r\n                  <h2 className=\"alert\">You are about to fund this farm !</h2>\r\n                  <p className=\"p-alert\"> You can fund this farm by increasing or reducing the number of units to suit\r\n                    what you’d love to fund. As your number of farms changes, The Total Price, Total Returns and Total\r\n                    Payout are automatically calculated for you to see. Satisfied? Click on Pay Now.</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"col-sm-12\">\r\n            <div className=\"panel panel-primary\" data-collapsed=\"0\">\r\n              <div className=\"panel-body\">\r\n                <div className=\"col-md-6\">\r\n                  <div className=\"row\">\r\n                    <div className=\"col-md-8 fundh2 text-center\">\r\n                      <p>Selected Farm</p>\r\n                      <strong>{this.state.farmDetails.title}</strong>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"row\">\r\n                    <div className=\"col-md-6\">\r\n                      <p>Price Per Unit</p>\r\n                      <p className=\"ptag\">₦{this.state.farmDetails.price_per_unit}</p>\r\n                    </div>\r\n                    <div className=\"col-md-6\">\r\n                      <p className=\"\">Returns</p>\r\n                      <p className=\"ptag\">{this.state.farmDetails.roi}%</p>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"row\" id=\"row2\">\r\n                    <div className=\"col-md-\">\r\n                      <div className=\"col-md-6\">\r\n                        <p>Total units</p>\r\n                        <p className=\"ptag\">{this.state.farmDetails.total_units}</p>\r\n                      </div>\r\n                      <div className=\"col-md-6\">\r\n                        <p className=\"\">Available</p>\r\n                        <p className=\"ptag\">{this.state.farmDetails.total_units - this.state.farmDetails.sold_out}</p>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"row\">\r\n                    <div className=\"col-md-\">\r\n                      <div className=\"col-md-6\">\r\n                        <p>Duration</p>\r\n                        <p className=\"ptag\">{this.calculateMonth( new Date(this.state.farmDetails.funding_starts),new Date(this.state.farmDetails.funding_ends))} month(s)</p>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"col-md-6\">\r\n                  <div className=\"row\">\r\n                    <div className=\"col-md-12\">\r\n                      <h2 className=\"fundh21 text-center\"><strong>Confirmation</strong></h2>\r\n                    </div>\r\n                    <br/>\r\n                      <div className=\"row text-center\">\r\n                        <div className=\"col-md-4\">\r\n                          <p className=\"\">No of units</p>\r\n                          <input name=\"units\" type=\"number\" className=\"col-sm-2 form-control input-unit\"\r\n                                 placeholder={'1 to '+(this.state.farmDetails.total_units - this.state.farmDetails.sold_out)} value={this.state.totalUnitsInput} min=\"1\"  max={this.state.farmDetails.total_units - this.state.farmDetails.sold_out} onChange={this.handleChange} />\r\n                        </div>\r\n                        <div className=\"col-md-4\">\r\n                          <p className=\"\">Unit Price</p>\r\n                          <p className=\"ptag\">\t&#8358;{this.state.farmDetails.price_per_unit}</p>\r\n                        </div>\r\n                        <div className=\"col-md-4\">\r\n                          <p className=\"\">Return & duration</p>\r\n                          <p className=\"ptag\">{this.state.farmDetails.roi}% in {this.calculateMonth( new Date(this.state.farmDetails.funding_starts),new Date(this.state.farmDetails.funding_ends))} month(s)</p>\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"row text-center\" id=\"row2\">\r\n                        <div className=\"col-md-4\">\r\n                          <p className=\"\">Total Price</p>\r\n                          <p className=\"ptag\">\t&#8358;{this.state.calcTotalPrice}</p>\r\n                        </div>\r\n                        <div className=\"col-md-4\">\r\n                          <p className=\"\">Total Returns</p>\r\n                          <p className=\"ptag\">\t&#8358;{this.state.calcTotalReturns}</p>\r\n                        </div>\r\n                        <div className=\"col-md-4\">\r\n                          <p className=\"\">Total Payout</p>\r\n                          <p className=\"ptag\">\t&#8358;{this.state.calcTotalPayOut}</p>\r\n                        </div>\r\n                      </div>\r\n                  </div>\r\n                  <div className=\"row\">\r\n                    <div className=\"col-sm-2\">\r\n                      <a href=\"#\">\r\n                        <button type=\"button\" disabled={this.state.isEnabled?\"\":\"disabled\"} className=\"btn btn-success\">Fund Now</button>\r\n                      </a>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </section>\r\n      </DashBoardLayOut>\r\n    )\r\n  }\r\n}\r\n\r\nexport default allFarms;\r\n"]},"metadata":{},"sourceType":"module"}